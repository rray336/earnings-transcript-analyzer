{% extends "base.html" %}

{% block title %}Analysis Results - Earnings Analyzer{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="fas fa-chart-bar me-2"></i>Analysis Results</h1>
    <a href="{{ url_for('index') }}" class="btn btn-outline-primary">
        <i class="fas fa-upload me-2"></i>Analyze More Files
    </a>
</div>

<!-- Key Insights for TSN -->
<div class="card mb-4 shadow border-primary">
    <div class="card-header bg-primary text-white">
        <h4 class="card-title mb-0">
            <i class="fas fa-lightbulb me-2"></i>Key Insights for TSN Stock Predictions
        </h4>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h6><i class="fas fa-star text-warning me-2"></i>Most Predictive Factors:</h6>
                <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-arrow-right text-primary me-2"></i><strong>Guidance vs Expectations</strong> (11.9%) - Most important predictor</li>
                    <li><i class="fas fa-arrow-right text-primary me-2"></i><strong>EPS vs Expectations</strong> (11.0%) - Earnings surprises matter</li>
                    <li><i class="fas fa-arrow-right text-primary me-2"></i><strong>Uncertainty Indicators</strong> (10.0%) - Language analysis works</li>
                    <li><i class="fas fa-arrow-right text-primary me-2"></i><strong>Concern Ratio</strong> (7.5%) - Analyst concern detection</li>
                </ul>
            </div>
            <div class="col-md-6">
                <h6><i class="fas fa-chart-line text-success me-2"></i>TSN Analysis Insights:</h6>
                <ul class="list-unstyled ms-3">
                    <li><i class="fas fa-check-circle text-success me-2"></i>Guidance performance drives stock movement</li>
                    <li><i class="fas fa-check-circle text-success me-2"></i>Q&A sentiment more telling than prepared remarks</li>
                    <li><i class="fas fa-check-circle text-success me-2"></i>Management uncertainty language is predictive</li>
                    <li><i class="fas fa-check-circle text-success me-2"></i>Question density correlates with volatility</li>
                </ul>
            </div>
        </div>
        <div class="alert alert-info mt-3 mb-0">
            <small><i class="fas fa-info-circle me-2"></i>Based on analysis of 11 TSN earnings transcripts (1Q23-3Q25) with enhanced ML model featuring 21 predictive factors.</small>
        </div>
    </div>
</div>

<!-- Analytical Tools Description -->
<div class="alert alert-info mb-4">
    <h5><i class="fas fa-cogs me-2"></i>Analytical Tools Used</h5>
    <div class="row">
        <div class="col-md-3">
            <strong><i class="fas fa-brain me-2"></i>Sentiment Analysis:</strong>
            <small class="text-muted d-block">TextBlob & VADER algorithms analyze emotional tone and confidence levels in prepared remarks and Q&A sessions.</small>
        </div>
        <div class="col-md-3">
            <strong><i class="fas fa-tags me-2"></i>Question Categorization:</strong>
            <small class="text-muted d-block">Natural language processing categorizes analyst questions into 8 topics: guidance, margins, revenue, competition, strategy, product, market, and financial.</small>
        </div>
        <div class="col-md-3">
            <strong><i class="fas fa-exclamation-triangle me-2"></i>Concern Detection:</strong>
            <small class="text-muted d-block">Pattern recognition identifies evasive language, hedging, uncertainty, and defensive responses in management answers.</small>
        </div>
        <div class="col-md-3">
            <strong><i class="fas fa-chart-line me-2"></i>Call Strength Assessment:</strong>
            <small class="text-muted d-block">Composite scoring evaluates confidence indicators, financial strength metrics, and uncertainty levels across transcript sections.</small>
        </div>
    </div>
    <div class="row mt-2">
        <div class="col-md-12">
            <strong><i class="fas fa-robot me-2"></i>Predictive Modeling (when earnings data available):</strong>
            <small class="text-muted d-block">Random Forest machine learning model predicts stock price movements using sentiment, call strength, concern levels, and earnings performance data. Features include R² accuracy score and feature importance rankings.</small>
        </div>
    </div>
</div>

<!-- Predictive Model Results -->
{% if results.model.available and results.model.results %}
<div class="card mb-4 shadow border-success">
    <div class="card-header bg-success text-white">
        <h4 class="card-title mb-0">
            <i class="fas fa-robot me-2"></i>
            Predictive Model Results
            {% if results.model.results.using_saved_model %}
                <span class="badge bg-light text-dark ms-2">Using Saved Model</span>
            {% endif %}
        </h4>
    </div>
    <div class="card-body">
        <div class="row mb-3">
            <div class="col-md-6">
                <div class="metric-card text-center p-3 border rounded">
                    <div class="metric-value text-success">{{ results.model.results.r2_score }}</div>
                    <div class="metric-label">R² Score</div>
                    <small class="text-muted">Model Accuracy</small>
                </div>
            </div>
            <div class="col-md-6">
                <div class="metric-card text-center p-3 border rounded">
                    <div class="metric-value text-info">{{ results.model.results.mse }}</div>
                    <div class="metric-label">Mean Squared Error</div>
                    <small class="text-muted">Prediction Error</small>
                </div>
            </div>
        </div>
        
        <h6><i class="fas fa-chart-bar me-2"></i>Top 5 Most Important Features:</h6>
        <div class="table-responsive">
            <table class="table table-sm">
                <thead>
                    <tr>
                        <th>Feature</th>
                        <th>Importance</th>
                        <th>Impact</th>
                    </tr>
                </thead>
                <tbody>
                    {% if results.model.results.model_needs_retraining %}
                        <tr>
                            <td colspan="3" class="text-center">
                                <div class="alert alert-warning mb-0">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <strong>Model Needs Retraining</strong><br>
                                    <small>The current model was trained with insufficient data, resulting in zero feature importance values. Please <a href="{{ url_for('train') }}" class="alert-link">retrain the model</a> with more diverse transcript and earnings data for reliable predictions.</small>
                                </div>
                            </td>
                        </tr>
                    {% else %}
                        {% for feature in results.model.results.feature_importance %}
                        <tr>
                            <td>{{ feature.feature.replace('_', ' ').title() }}</td>
                            <td>{{ (feature.importance * 100)|round(1) }}%</td>
                            <td>
                                <div class="progress" style="height: 8px;">
                                    <div class="progress-bar bg-primary" style="width: {{ (feature.importance * 100)|round }}%"></div>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% elif results.model.available == false %}
<div class="alert alert-warning mb-4">
    <h6><i class="fas fa-info-circle me-2"></i>Predictive Model Not Available</h6>
    <p class="mb-0">To enable stock movement predictions, you need to provide earnings performance data (Excel file with EPS vs expectations, guidance vs expectations, and stock reaction data). The current analysis is based on transcript content only.</p>
</div>
{% endif %}

<!-- Transcript Analysis Results -->
{% for result in results.transcripts %}
<div class="card mb-4 shadow">
    <div class="card-header bg-light">
        <div class="row align-items-center">
            <div class="col">
                <h4 class="card-title mb-0">
                    <i class="fas fa-file-pdf text-danger me-2"></i>
                    {{ result.file_name }}
                </h4>
            </div>
            <div class="col-auto">
                <span class="badge bg-secondary">{{ result.word_count }} words</span>
                <span class="badge bg-success">Browser Only</span>
            </div>
        </div>
    </div>
    
    <div class="card-body">
        <!-- Key Metrics Row -->
        <div class="row mb-4">
            <div class="col-md-4">
                <div class="metric-card text-center p-3 border rounded" data-bs-toggle="tooltip" title="Click for details">
                    <div class="metric-value text-{{ result.sentiment_color }}">
                        {{ result.overall_sentiment }}
                    </div>
                    <div class="metric-label">Overall Sentiment</div>
                    <span class="badge bg-{{ result.sentiment_color }}">{{ result.sentiment_label }}</span>
                    <button class="btn btn-sm btn-outline-secondary mt-2" data-bs-toggle="modal" data-bs-target="#sentimentModal{{ loop.index }}">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
            </div>
            <div class="col-md-4">
                <div class="metric-card text-center p-3 border rounded" data-bs-toggle="tooltip" title="Click for details">
                    <div class="metric-value text-{{ result.strength_color }}">
                        {{ result.call_strength }}
                    </div>
                    <div class="metric-label">Call Strength</div>
                    <span class="badge bg-{{ result.strength_color }}">{{ result.strength_level }}</span>
                    <button class="btn btn-sm btn-outline-secondary mt-2" data-bs-toggle="modal" data-bs-target="#strengthModal{{ loop.index }}">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
            </div>
            <div class="col-md-4">
                <div class="metric-card text-center p-3 border rounded" data-bs-toggle="tooltip" title="Click for details">
                    <div class="metric-value text-{{ result.concern_color }}">
                        {{ (result.concern_ratio * 100)|round(1) }}%
                    </div>
                    <div class="metric-label">Concern Level</div>
                    <span class="badge bg-{{ result.concern_color }}">{{ result.concern_level }}</span>
                    <button class="btn btn-sm btn-outline-secondary mt-2" data-bs-toggle="modal" data-bs-target="#concernModal{{ loop.index }}">
                        <i class="fas fa-info-circle"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Sentiment Modal -->
        <div class="modal fade" id="sentimentModal{{ loop.index }}" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-smile me-2"></i>Overall Sentiment Score Explained
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-info">
                            <strong>Current Score:</strong> {{ result.overall_sentiment }} ({{ result.sentiment_label }})
                        </div>
                        
                        <h6><i class="fas fa-chart-line me-2"></i>Score Range & Meaning:</h6>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="score-range p-3 border rounded bg-light">
                                    <strong>Range:</strong> -1.0 to +1.0<br>
                                    <strong>Algorithm:</strong> TextBlob sentiment analysis
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="score-interpretation">
                                    <div class="mb-2">
                                        <span class="badge bg-success">+0.1 to +1.0</span> Positive sentiment
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-warning">-0.1 to +0.1</span> Neutral sentiment
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-danger">-1.0 to -0.1</span> Negative sentiment
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h6><i class="fas fa-lightbulb me-2"></i>What This Means:</h6>
                        <ul>
                            <li><strong>+0.5 to +1.0:</strong> Very confident, optimistic tone. Management sounds enthusiastic about business performance.</li>
                            <li><strong>+0.1 to +0.5:</strong> Moderately positive. Good results with cautious optimism.</li>
                            <li><strong>-0.1 to +0.1:</strong> Neutral tone. Matter-of-fact presentation without strong emotions.</li>
                            <li><strong>-0.5 to -0.1:</strong> Somewhat negative. Concerns about challenges or disappointing results.</li>
                            <li><strong>-1.0 to -0.5:</strong> Very negative tone. Significant problems or poor performance discussed.</li>
                        </ul>

                        <div class="alert alert-warning">
                            <small><strong>Note:</strong> This score analyzes the emotional tone of language used, not just financial results. A low score may indicate cautious management even with good results.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Call Strength Modal -->
        <div class="modal fade" id="strengthModal{{ loop.index }}" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-chart-line me-2"></i>Call Strength Score Explained
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-info">
                            <strong>Current Score:</strong> {{ result.call_strength }} ({{ result.strength_level }})
                        </div>
                        
                        <h6><i class="fas fa-chart-line me-2"></i>Score Range & Meaning:</h6>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="score-range p-3 border rounded bg-light">
                                    <strong>Range:</strong> 0 to 8+ (typically 0-6)<br>
                                    <strong>Method:</strong> Composite scoring algorithm
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="score-interpretation">
                                    <div class="mb-2">
                                        <span class="badge bg-success">3.0+</span> Strong call
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-warning">1.5 - 3.0</span> Moderate strength
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-danger">0 - 1.5</span> Weak call
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h6><i class="fas fa-cogs me-2"></i>How It's Calculated:</h6>
                        <div class="calculation-breakdown">
                            <div class="mb-3">
                                <strong>Confidence Indicators (+):</strong>
                                <ul class="small">
                                    <li>Words like "confident", "strong", "solid", "robust", "optimistic"</li>
                                    <li>Financial strength terms: "revenue growth", "margin expansion"</li>
                                    <li>Positive business metrics and achievements</li>
                                </ul>
                            </div>
                            <div class="mb-3">
                                <strong>Uncertainty Indicators (-):</strong>
                                <ul class="small">
                                    <li>Words like "uncertain", "challenging", "difficult", "volatile"</li>
                                    <li>Hedging language and defensive responses in Q&A</li>
                                    <li>Expressions of caution or concern</li>
                                </ul>
                            </div>
                        </div>

                        <h6><i class="fas fa-lightbulb me-2"></i>What This Means:</h6>
                        <ul>
                            <li><strong>4.0+:</strong> Very strong call. Management is highly confident, uses strong financial language, minimal uncertainty.</li>
                            <li><strong>3.0-4.0:</strong> Strong call. Good confidence with solid business metrics.</li>
                            <li><strong>2.0-3.0:</strong> Moderate strength. Balanced presentation with some caution.</li>
                            <li><strong>1.0-2.0:</strong> Weak call. More uncertainty than confidence, defensive tone.</li>
                            <li><strong>0-1.0:</strong> Very weak call. High uncertainty, many challenges discussed.</li>
                        </ul>

                        <div class="alert alert-warning">
                            <small><strong>Note:</strong> A lower score doesn't always mean poor financial performance - it may indicate a cautious management style or challenging market conditions.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Concern Level Modal -->
        <div class="modal fade" id="concernModal{{ loop.index }}" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-exclamation-triangle me-2"></i>Concern Level Explained
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="alert alert-info">
                            <strong>Current Level:</strong> {{ (result.concern_ratio * 100)|round(1) }}% ({{ result.concern_level }})
                        </div>
                        
                        <h6><i class="fas fa-chart-line me-2"></i>Percentage Range & Meaning:</h6>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="score-range p-3 border rounded bg-light">
                                    <strong>Range:</strong> 0% to 100%<br>
                                    <strong>Method:</strong> Pattern recognition analysis
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="score-interpretation">
                                    <div class="mb-2">
                                        <span class="badge bg-danger">40%+</span> High concern level
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-warning">20% - 40%</span> Medium concern
                                    </div>
                                    <div class="mb-2">
                                        <span class="badge bg-success">0% - 20%</span> Low concern
                                    </div>
                                </div>
                            </div>
                        </div>

                        <h6><i class="fas fa-search me-2"></i>What We Look For:</h6>
                        <div class="concern-indicators mb-3">
                            <div class="mb-3">
                                <strong>Hedging Language:</strong>
                                <div class="small text-muted">"However", "but", "although", "despite", "while", "cautious"</div>
                            </div>
                            <div class="mb-3">
                                <strong>Uncertainty Expressions:</strong>
                                <div class="small text-muted">"Uncertain", "unclear", "challenging", "difficult", "volatile"</div>
                            </div>
                            <div class="mb-3">
                                <strong>Defensive Responses:</strong>
                                <div class="small text-muted">"Manage", "control", "monitor", "watch", "careful"</div>
                            </div>
                            <div class="mb-3">
                                <strong>Evasive Language:</strong>
                                <div class="small text-muted">"I think", "maybe", "probably", "we believe", "as I said"</div>
                            </div>
                        </div>

                        <h6><i class="fas fa-lightbulb me-2"></i>What This Means:</h6>
                        <ul>
                            <li><strong>0-10%:</strong> Excellent. Direct, confident responses with minimal hedging.</li>
                            <li><strong>10-20%:</strong> Good. Mostly straightforward with normal business caution.</li>
                            <li><strong>20-30%:</strong> Moderate concern. Some defensive language or uncertainty.</li>
                            <li><strong>30-40%:</strong> Elevated concern. Frequent hedging or evasive responses.</li>
                            <li><strong>40%+:</strong> High concern. Significant uncertainty, defensive tone, or evasiveness.</li>
                        </ul>

                        <div class="alert alert-warning">
                            <small><strong>Important:</strong> This measures the <em>percentage of responses</em> containing concern indicators, not the severity of business issues. High percentages may indicate management uncertainty or difficult questions from analysts.</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Detailed Analysis Tabs -->
        <ul class="nav nav-tabs" id="analysisTab{{ loop.index }}" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="sentiment-tab{{ loop.index }}" data-bs-toggle="tab" 
                        data-bs-target="#sentiment{{ loop.index }}" type="button" role="tab">
                    <i class="fas fa-smile me-2"></i>Sentiment Analysis
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="categories-tab{{ loop.index }}" data-bs-toggle="tab" 
                        data-bs-target="#categories{{ loop.index }}" type="button" role="tab">
                    <i class="fas fa-tags me-2"></i>Question Categories
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="concerns-tab{{ loop.index }}" data-bs-toggle="tab" 
                        data-bs-target="#concerns{{ loop.index }}" type="button" role="tab">
                    <i class="fas fa-exclamation-triangle me-2"></i>Concerns
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="questions-tab{{ loop.index }}" data-bs-toggle="tab" 
                        data-bs-target="#questions{{ loop.index }}" type="button" role="tab">
                    <i class="fas fa-question-circle me-2"></i>Questions
                </button>
            </li>
        </ul>

        <div class="tab-content mt-3" id="analysisTabContent{{ loop.index }}">
            <!-- Sentiment Analysis Tab -->
            <div class="tab-pane fade show active" id="sentiment{{ loop.index }}" role="tabpanel">
                <div class="row">
                    <div class="col-md-4">
                        <div class="sentiment-box">
                            <h6><i class="fas fa-microphone me-2"></i>Prepared Remarks</h6>
                            <div class="progress mb-2">
                                <div class="progress-bar bg-{{ 'success' if result.prepared_sentiment > 0 else 'danger' if result.prepared_sentiment < 0 else 'warning' }}" 
                                     style="width: {{ ((result.prepared_sentiment + 1) * 50)|round }}%"></div>
                            </div>
                            <span class="text-muted">{{ result.prepared_sentiment }}</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="sentiment-box">
                            <h6><i class="fas fa-comments me-2"></i>Q&A Session</h6>
                            <div class="progress mb-2">
                                <div class="progress-bar bg-{{ 'success' if result.qa_sentiment > 0 else 'danger' if result.qa_sentiment < 0 else 'warning' }}" 
                                     style="width: {{ ((result.qa_sentiment + 1) * 50)|round }}%"></div>
                            </div>
                            <span class="text-muted">{{ result.qa_sentiment }}</span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        {% if result.vader_compound is defined %}
                        <div class="sentiment-box">
                            <h6><i class="fas fa-brain me-2"></i>VADER Score</h6>
                            <div class="progress mb-2">
                                <div class="progress-bar bg-{{ 'success' if result.vader_compound > 0 else 'danger' if result.vader_compound < 0 else 'warning' }}" 
                                     style="width: {{ ((result.vader_compound + 1) * 50)|round }}%"></div>
                            </div>
                            <span class="text-muted">{{ result.vader_compound }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Question Categories Tab -->
            <div class="tab-pane fade" id="categories{{ loop.index }}" role="tabpanel">
                <div class="row">
                    {% for category, count in result.top_categories.items() %}
                    <div class="col-md-4 mb-3">
                        <div class="category-card p-3 border rounded">
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="fw-bold text-capitalize">{{ category }}</span>
                                <span class="badge bg-primary">{{ count }}</span>
                            </div>
                            <div class="progress mt-2">
                                <div class="progress-bar" style="width: {{ (count / result.question_count * 100)|round }}%"></div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>

            <!-- Concerns Tab -->
            <div class="tab-pane fade" id="concerns{{ loop.index }}" role="tabpanel">
                <div class="alert alert-{{ result.concern_color }} alert-dismissible">
                    <h6><i class="fas fa-info-circle me-2"></i>Concern Analysis Summary</h6>
                    <p class="mb-0">
                        This transcript shows a <strong>{{ result.concern_level.lower() }}</strong> level of analyst concerns 
                        ({{ (result.concern_ratio * 100)|round(1) }}% of responses contain concern indicators).
                    </p>
                </div>
                
                <div class="row">
                    {% for concern_type, count in result.analyst_concerns.items() %}
                        {% if concern_type.endswith('_responses') and count > 0 %}
                        <div class="col-md-6 mb-3">
                            <div class="concern-item p-3 border rounded">
                                <div class="d-flex justify-content-between">
                                    <span class="text-capitalize">{{ concern_type.replace('_responses', '').replace('_', ' ') }}</span>
                                    <span class="badge bg-warning">{{ count }}</span>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- Questions Tab -->
            <div class="tab-pane fade" id="questions{{ loop.index }}" role="tabpanel">
                <div class="questions-list">
                    {% for question in result.questions %}
                    <div class="question-item mb-3 p-3 border rounded">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <h6 class="mb-0">Question {{ loop.index }}</h6>
                            <div>
                                {% for category in question.categories %}
                                <span class="badge bg-secondary me-1">{{ category }}</span>
                                {% endfor %}
                            </div>
                        </div>
                        <p class="text-muted mb-2">{{ question.text }}</p>
                        <div class="d-flex justify-content-between align-items-center">
                            <small class="text-muted">
                                Sentiment: {{ question.sentiment.textblob_polarity|round(3) }}
                            </small>
                            <div class="sentiment-indicator">
                                {% if question.sentiment.textblob_polarity > 0.1 %}
                                    <i class="fas fa-smile text-success"></i>
                                {% elif question.sentiment.textblob_polarity < -0.1 %}
                                    <i class="fas fa-frown text-danger"></i>
                                {% else %}
                                    <i class="fas fa-meh text-warning"></i>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    
                    {% if result.questions|length >= 10 %}
                    <div class="text-center">
                        <p class="text-muted">Showing first 10 questions from the Q&A session.</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endfor %}

<div class="text-center mt-4">
    <a href="{{ url_for('index') }}" class="btn btn-primary btn-lg">
        <i class="fas fa-upload me-2"></i>Analyze More Transcripts
    </a>
</div>
{% endblock %}